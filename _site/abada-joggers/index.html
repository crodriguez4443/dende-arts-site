<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="descritpion" content="">
    <title></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/contact.css">
    <link rel="stylesheet" href="/css/pages.css"> 

    <!-- OG meta descriptions -->
    <meta property="og:title" content="" />
    <meta property="og:description" content="" />
    <meta property="og:image" content="/img/dende-arts-logo2.png" />

    <!-- Primary font -->
    <link 
        rel="preload" 
        href="/fonts/DMSans-Variable.woff2" 
        as="font" 
        type="font/woff2" 
        crossorigin
    >

    <!-- Load Flavicon -->

    <link rel="icon" type="img" href="/img/dende-arts-logo.png">

</head>
<body>
    <!-- _includes/cart-sidebar.njk -->
<div id="cart-sidebar" class="cart-sidebar">
  <div class="cart-header flex-row">
    <h3>Your Cart</h3>
    <button id="close-cart" class="close-cart">×</button>
  </div>
  <div id="cart-items" class="cart-items">
  <!-- Cart items will be dynamically inserted here -->
  </div>
  <div class="cart-footer">
    <div class="cart-total">
      <span>Total:</span>
      <span id="cart-total-amount"></span>
    </div>
    <button id="checkout-button" class="checkout-button">
      Proceed to Checkout
    </button>
  </div>
</div>
<div id="cart-overlay" class="cart-overlay"></div>

    <main> 
        
<section class="main-grid product-sale-page">
    <div class="nav-content">
    <!-- use shortcode for these image -->
    <div class="logo-link-container">
        <a href="/">
            <picture class="logo-link">
            <source type="image/webp" srcset="/img/optimized/XEkAbwk2b4-400.webp 400w, /img/optimized/XEkAbwk2b4-450.webp 450w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/XEkAbwk2b4-400.jpeg 400w, /img/optimized/XEkAbwk2b4-450.jpeg 450w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/XEkAbwk2b4-400.png 400w, /img/optimized/XEkAbwk2b4-450.png 450w" sizes="100vw">
            <img src="/img/optimized/XEkAbwk2b4-450.webp" width="450" height="450" alt="dende arts logo" loading="eager" decoding="async">
        </picture>
            <picture class="logo-link-lg">
            <source type="image/webp" srcset="/img/optimized/YxXHLNTgsJ-400.webp 400w, /img/optimized/YxXHLNTgsJ-654.webp 654w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/YxXHLNTgsJ-400.jpeg 400w, /img/optimized/YxXHLNTgsJ-654.jpeg 654w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/YxXHLNTgsJ-400.png 400w, /img/optimized/YxXHLNTgsJ-654.png 654w" sizes="100vw">
            <img src="/img/optimized/YxXHLNTgsJ-654.webp" width="654" height="139" alt="dende arts logo" loading="eager" decoding="async">
        </picture>
        </a>
    </div>
    <!-- use shortcode for these image -->
    <div class="nav-container">
        <button class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="overlay"></div>
        <nav class="nav-menu">
            <a href="/">Home</a>
            
            <a href="/abada-joggers-landing/">Abadas</a>
            <a href="/songbook/">Songs</a>
            
            <a href="/blog/">Blog</a>
            <a href="/bulk-orders/">Bulk Orders</a>
            <div class="flex-box">
                <a href="#" class="cart-toggle flex-row" onclick="return false;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
                    </svg>
                    (<span class="cart-count">0</span>)
                </a>
            </div>  
        </nav>
    </div>
</div>

    <div class="product-image-wrapper">
        <!-- Container for additional product photos -->
        <div class="additional-photos-container" id="thumbnailContainer">
            
                
                      
                        <img src="https://cdn.swell.store/dendearts/67c47956b788af0012696e18/332457b5fed18f5179c3be524d5c17a6/8.png" 
                            alt="Abada Joggers - Featured Image 1"
                            class="thumbnail-image active"
                            loading="lazy"
                            width="80"
                            height="80"
                            data-index="0"
                            onclick="swapImages(this)">
                    
                
                      
                        <img src="https://cdn.swell.store/dendearts/67c4795e84e7ab0012bbef38/7a0683f8ef1330f44ee2120706b5ecee/Lena%20model.png" 
                            alt="Abada Joggers - Additional Image 2"
                            class="thumbnail-image "
                            loading="lazy"
                            width="80"
                            height="80"
                            data-index="1"
                            onclick="swapImages(this)">
                    
                
                      
                        <img src="https://cdn.swell.store/dendearts/67c47964dbb06a00121f50c2/3ee4e2be3f870a887b7569248b4bfa27/10.png" 
                            alt="Abada Joggers - Additional Image 3"
                            class="thumbnail-image "
                            loading="lazy"
                            width="80"
                            height="80"
                            data-index="2"
                            onclick="swapImages(this)">
                    
                
                      
                        <img src="https://cdn.swell.store/dendearts/67977eafff0ff4001200d6c9/9937040028c24e9ac58805e9cd6e3b71/8.png" 
                            alt="Abada Joggers - Additional Image 4"
                            class="thumbnail-image "
                            loading="lazy"
                            width="80"
                            height="80"
                            data-index="3"
                            onclick="swapImages(this)">
                    
                
                    
                
            
        </div>

        <!-- Primary image container -->
        <div class="left-half-img-container product-feature-image">
            
                <img src="https://cdn.swell.store/dendearts/67c47956b788af0012696e18/332457b5fed18f5179c3be524d5c17a6/8.png" 
                    alt="Abada Joggers"
                    class="main-product-image"
                    id="mainImage"
                    data-index="0"
                    width="400"
                    height="400">
            
        </div>
    </div>

    <div class="right-half-content product-sale-content">
        
        <div class="product-card">
            
                <h1 class="product-page-title">Abada Joggers</h1>
                <p class="product-subtext">Unisex Mid-rise 2.0</p>
                <div class="price">
                    Price: $ 69.5 USD
                </div>

                
                    <div class="description">
                        <span style="white-space:pre-wrap;"><strong>Elevate your capoeira performance with the best capoeira abadas</strong></span><br><strong><br></strong><span style="white-space:pre-wrap;">Abada Jogger is here to offer you an alternative to the mob of unflattering capoeira uniforms out there.&nbsp;<br>Made with the most luxurious 4-way stretch polyester, Abada Jogger is mid-rise and tapered fit that bring comfort and style to your capoeira journey.</span><br><br><span style="white-space:pre-wrap;"><img src="https://cdn.swell.store/dendearts/67c4699422a8aa001217bb1b/6407db69ca698a8cb2af207bc7980c8f/Abada-jogger-sizing-chart.png" style="width: 575px;" class="fr-fic fr-dib"></span><br>
                    </div>
                

                
                    <div class="features-container padding-bottom-1">
                        <div class="feature">
                            <div class="feature-image-container">
                                <picture class="feature-icon">
            <source type="image/svg+xml" srcset="/img/optimized/MhM95fMTX4-50.svg 50w" sizes="100vw">
<source type="image/webp" srcset="/img/optimized/MhM95fMTX4-50.webp 50w, /img/optimized/MhM95fMTX4-400.webp 400w, /img/optimized/MhM95fMTX4-800.webp 800w, /img/optimized/MhM95fMTX4-1280.webp 1280w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/MhM95fMTX4-50.jpeg 50w, /img/optimized/MhM95fMTX4-400.jpeg 400w, /img/optimized/MhM95fMTX4-800.jpeg 800w, /img/optimized/MhM95fMTX4-1280.jpeg 1280w" sizes="100vw">
            <img src="/img/optimized/MhM95fMTX4-1280.webp" width="1280" height="1280" alt="4-way stretch material" loading="lazy" decoding="async">
        </picture>
                            </div>
                            <p>4-WAY STRETCH</p>
                        </div>
                        <div class="feature">
                            <div class="feature-image-container">
                                <picture class="feature-icon">
            <source type="image/svg+xml" srcset="/img/optimized/EXSSdFJe0y-46.svg 46w" sizes="100vw">
<source type="image/webp" srcset="/img/optimized/EXSSdFJe0y-46.webp 46w, /img/optimized/EXSSdFJe0y-400.webp 400w, /img/optimized/EXSSdFJe0y-800.webp 800w, /img/optimized/EXSSdFJe0y-1280.webp 1280w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/EXSSdFJe0y-46.jpeg 46w, /img/optimized/EXSSdFJe0y-400.jpeg 400w, /img/optimized/EXSSdFJe0y-800.jpeg 800w, /img/optimized/EXSSdFJe0y-1280.jpeg 1280w" sizes="100vw">
            <img src="/img/optimized/EXSSdFJe0y-1280.webp" width="1280" height="1307" alt="abadas with elastic waistband" loading="[object Object]" decoding="async">
        </picture>
                            </div>
                            <p>Elastic Waistband</p>
                        </div>
                        <div class="feature">
                            <div class="feature-image-container">
                                <picture class="feature-icon">
            <source type="image/svg+xml" srcset="/img/optimized/AZZxf_LMnM-50.svg 50w" sizes="100vw">
<source type="image/webp" srcset="/img/optimized/AZZxf_LMnM-50.webp 50w, /img/optimized/AZZxf_LMnM-400.webp 400w, /img/optimized/AZZxf_LMnM-800.webp 800w, /img/optimized/AZZxf_LMnM-1280.webp 1280w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/AZZxf_LMnM-50.jpeg 50w, /img/optimized/AZZxf_LMnM-400.jpeg 400w, /img/optimized/AZZxf_LMnM-800.jpeg 800w, /img/optimized/AZZxf_LMnM-1280.jpeg 1280w" sizes="100vw">
            <img src="/img/optimized/AZZxf_LMnM-1280.webp" width="1280" height="1280" alt="abadas with tapered fit" loading="[object Object]" decoding="async">
        </picture>
                            </div>
                            <p>Tapered Fit</p>
                        </div>
                        <div class="feature">
                            <div class="feature-image-container">
                                <picture class="feature-icon">
            <source type="image/svg+xml" srcset="/img/optimized/72GbiEoTWp-50.svg 50w" sizes="100vw">
<source type="image/webp" srcset="/img/optimized/72GbiEoTWp-50.webp 50w, /img/optimized/72GbiEoTWp-400.webp 400w, /img/optimized/72GbiEoTWp-800.webp 800w, /img/optimized/72GbiEoTWp-1280.webp 1280w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/72GbiEoTWp-50.jpeg 50w, /img/optimized/72GbiEoTWp-400.jpeg 400w, /img/optimized/72GbiEoTWp-800.jpeg 800w, /img/optimized/72GbiEoTWp-1280.jpeg 1280w" sizes="100vw">
            <img src="/img/optimized/72GbiEoTWp-1280.webp" width="1280" height="1280" alt="abadas with zipper pocket" loading="[object Object]" decoding="async">
        </picture>
                            </div>
                            <p>Zippered Pocket</p>
                        </div>
                    </div>
                
                
                <div class="flex-box padding-bottom-2 ">
                    
                        <div class="options">
                            
                                <div class="option-group">
                                    <label for="Size">Size:</label>
                                    <select id="Size" name="Size">
                                        
                                            <option value="Extra-Small">Extra-Small</option>
                                        
                                            <option value="Small">Small</option>
                                        
                                            <option value="Medium">Medium</option>
                                        
                                            <option value="Large">Large</option>
                                        
                                            <option value="Extra-Large">Extra-Large</option>
                                        
                                    </select>
                                </div>
                            
                        </div>
                    
                    
                    <!-- Quantity Control -->
                    <div class="quantity-control">
                        <label for="quantity">Quantity:</label>
                        <div class="quantity-wrapper">
                            <button class="quantity-btn minus" type="button">-</button>
                            <input type="number" id="quantity" name="quantity" value="1" min="1" readonly>
                            <button class="quantity-btn plus" type="button">+</button>
                        </div>
                    </div>
                </div>

                <div class="flex-box">
                    <button id="addToCart" 
                            onclick="addToCart('6796e8f527aea3001290a682')"
                            class="add-to-cart-button">
                        Add to Cart
                    </button>
                    
                    <!-- remove buy now button
                    <button id="buyNow" 
                            onclick="buyNow('6796e8f527aea3001290a682')"
                            class="buy-now-button">
                        Checkout
                    </button>
                    -->
                </div>
            
        </div>
    </div>
</section>

<script>
async function addToCart(productId) {
    const quantity = document.getElementById('quantity').value;
    const button = document.getElementById('addToCart');
    const options = {};
    
    // Gather selected options if they exist
    document.querySelectorAll('.option-group select').forEach(select => {
        options[select.name] = select.value;
    });

    // Show immediate feedback
    button.disabled = true;
    button.textContent = 'Adding...';
    
    // Open cart sidebar immediately for better UX - better perceived performance
    const cartSidebar = document.getElementById('cart-sidebar');
    const cartOverlay = document.getElementById('cart-overlay');
    if (cartSidebar && cartOverlay) {
        cartSidebar.classList.add('active');
        cartOverlay.classList.add('active');
    }
    
    // Show loading state on the cart
    const cartItems = document.getElementById('cart-items');
    if (cartItems) {
        cartItems.classList.add('loading');
    }
    
    try {
        // Use optimistic UI update - immediately show a temporary item in cart
        // This makes the cart feel more responsive while API call happens in background
        if (window.swellCartCount === undefined) {
            window.swellCartCount = 0;
        }
        window.swellCartCount += parseInt(quantity);
        updateCartCount();
        
        // Use our cached cart system
        await swell.cachedCart.addItem({
            product_id: productId,
            quantity: parseInt(quantity),
            options: options
        });

        // Show success feedback
        button.textContent = 'Added to Cart!';
        
        // Update the cart display with actual items
        const updateCartDisplayFn = window.updateCartDisplay;
        if (typeof updateCartDisplayFn === 'function') {
            updateCartDisplayFn();
        }
        
        // Reset button after a short delay
        setTimeout(() => {
            button.disabled = false;
            button.textContent = 'Add to Cart';
        }, 1500);

    } catch (error) {
        console.error('Add to cart error:', error);
        button.disabled = false;
        button.textContent = 'Add to Cart'; 
        alert('Error adding to cart: ' + error.message);
        
        // Remove loading state
        if (cartItems) {
            cartItems.classList.remove('loading');
        }
        
        // Update cart count based on actual value
        const cart = await swell.cachedCart.get();
        window.swellCartCount = cart?.itemQuantity || 0;
        updateCartCount();
    }
}


// Buy Now --> actually check out button now



    // Store all product images data
const productImages = JSON.parse('[{"id":"67977f16d47a330012afab26","file":{"height":1080,"md5":"332457b5fed18f5179c3be524d5c17a6","url":"https://cdn.swell.store/dendearts/67c47956b788af0012696e18/332457b5fed18f5179c3be524d5c17a6/8.png","width":1080}},{"id":"67977f16d47a330012afab27","file":{"height":1080,"md5":"7a0683f8ef1330f44ee2120706b5ecee","url":"https://cdn.swell.store/dendearts/67c4795e84e7ab0012bbef38/7a0683f8ef1330f44ee2120706b5ecee/Lena%20model.png","width":1080}},{"id":"67977f16d47a330012afab27","file":{"height":1080,"md5":"3ee4e2be3f870a887b7569248b4bfa27","url":"https://cdn.swell.store/dendearts/67c47964dbb06a00121f50c2/3ee4e2be3f870a887b7569248b4bfa27/10.png","width":1080}},{"id":"67977f16d47a330012afab27","file":{"height":1080,"md5":"9937040028c24e9ac58805e9cd6e3b71","url":"https://cdn.swell.store/dendearts/67977eafff0ff4001200d6c9/9937040028c24e9ac58805e9cd6e3b71/8.png","width":1080}},{"id":"67c46a18b68e7f00124df40b","file":{"height":768,"md5":"6407db69ca698a8cb2af207bc7980c8f","url":"https://cdn.swell.store/dendearts/67c4699422a8aa001217bb1b/6407db69ca698a8cb2af207bc7980c8f/Abada-jogger-sizing-chart.png","width":2304}}]');

function swapImages(thumbnailElement) {
    const mainImage = document.getElementById('mainImage');
    const thumbnails = document.querySelectorAll('.thumbnail-image');
    
    // Remove active class from all thumbnails
    thumbnails.forEach(thumb => thumb.classList.remove('active'));
    
    // Add active class to clicked thumbnail
    thumbnailElement.classList.add('active');

    // Get the index of clicked thumbnail
    const thumbnailIndex = parseInt(thumbnailElement.dataset.index);
    
    // Add fade out effect
    mainImage.style.opacity = '0';
    
    // Update main image after a brief delay (for transition effect)
    setTimeout(() => {
        mainImage.src = productImages[thumbnailIndex].file.url;
        mainImage.alt = productImages[thumbnailIndex].alt;
        mainImage.dataset.index = thumbnailIndex;
        mainImage.style.opacity = '1';
    }, 300);
}

// Initialize the first thumbnail as active
document.addEventListener('DOMContentLoaded', () => {
    const firstThumbnail = document.querySelector('.thumbnail-image');
    if (firstThumbnail) {
        firstThumbnail.classList.add('active');
    }
});

</script>

    </main>
    <footer class="footer main-grid">
        <div class="footer-top-content">
        <!-- Logo/Title Section -->
            <div class="footer-logo-link-container">
                <a href="/">
                    <picture class="footer-logo-link-lg">
            <source type="image/webp" srcset="/img/optimized/Cxrmjr60ac-400.webp 400w, /img/optimized/Cxrmjr60ac-800.webp 800w, /img/optimized/Cxrmjr60ac-900.webp 900w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/Cxrmjr60ac-400.jpeg 400w, /img/optimized/Cxrmjr60ac-800.jpeg 800w, /img/optimized/Cxrmjr60ac-900.jpeg 900w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/Cxrmjr60ac-400.png 400w, /img/optimized/Cxrmjr60ac-800.png 800w, /img/optimized/Cxrmjr60ac-900.png 900w" sizes="100vw">
            <img src="/img/optimized/Cxrmjr60ac-900.webp" width="900" height="450" alt="dende arts logo" loading="eager" decoding="async">
        </picture>
                </a>
            </div>
            <!-- Social Media Icons -->
            <div class="footer-social-large"> 
                <a href="https://www.instagram.com/dende_arts/" target="_blank" class="social-icon">
                    <picture class="instagram-logo">
            <source type="image/webp" srcset="/img/optimized/9Wae6hdbqR-25.webp 25w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/9Wae6hdbqR-25.jpeg 25w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/9Wae6hdbqR-25.png 25w" sizes="100vw">
            <img src="/img/optimized/9Wae6hdbqR-25.webp" width="25" height="24" alt="instagram logo" loading="lazy" decoding="async">
        </picture>
                </a>
                <a href="https://https://www.youtube.com/@Dendearts/videos" target="_blank" class="social-icon">
                    <picture class="youtube-logo">
            <source type="image/webp" srcset="/img/optimized/4492VL5Ckk-26.webp 26w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/4492VL5Ckk-26.jpeg 26w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/4492VL5Ckk-26.png 26w" sizes="100vw">
            <img src="/img/optimized/4492VL5Ckk-26.webp" width="26" height="24" alt="youtube logo" loading="lazy" decoding="async">
        </picture>
                </a>
                
            </div>
        </div>
        <div class="footer-bottom-content">

            <!-- Navigation Links -->
            <nav class="footer-nav">
                <a href="/">Home</a>
                
                <a href="/abada-joggers-landing/">Abadas</a>
                <a href="/songbook/">Songbook</a>
                
                <a href="/blog/">Blog</a>
                <a href="/bulk-orders/">Bulk Orders</a>
            </nav>

            <!-- Social Media Icons -->
            <div class="footer-social-small">
                <a href="https://www.instagram.com/dende_arts/" target="_blank" class="social-icon">
                    <picture class="instagram-logo">
            <source type="image/webp" srcset="/img/optimized/9Wae6hdbqR-25.webp 25w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/9Wae6hdbqR-25.jpeg 25w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/9Wae6hdbqR-25.png 25w" sizes="100vw">
            <img src="/img/optimized/9Wae6hdbqR-25.webp" width="25" height="24" alt="instagram logo" loading="lazy" decoding="async">
        </picture>
                </a>
                <a href="https://https://www.youtube.com/@Dendearts/videos" target="_blank" class="social-icon">
                    <picture class="youtube-logo">
            <source type="image/webp" srcset="/img/optimized/4492VL5Ckk-26.webp 26w" sizes="100vw">
<source type="image/jpeg" srcset="/img/optimized/4492VL5Ckk-26.jpeg 26w" sizes="100vw">
<source type="image/png" srcset="/img/optimized/4492VL5Ckk-26.png 26w" sizes="100vw">
            <img src="/img/optimized/4492VL5Ckk-26.webp" width="26" height="24" alt="youtube logo" loading="lazy" decoding="async">
        </picture>
                </a>  
            </div>
    
            <!-- Copyright -->
            <div class="footer-copyright">
                <p>Copyright © <span id="current-year"></span> Solstice Web Studio LLC | All Rights Reserved</p>
            </div>
        </div>
    </footer>

    <script src="/js/nav.js" defer></script>
    <!-- script to update copyright year -->
    <script>document.getElementById('current-year').textContent = new Date().getFullYear();</script>
    <script src="https://unpkg.com/lunr/lunr.js" defer></script>
    <script src="/js/search.js" defer></script>
    <script src="/js/product-quantity.js" defer></script>
    
    <!-- Add our new cart utils -->
    <script src="/js/cart-utils.js" defer></script>
    <script src="/js/cart-display.js" defer></script>

    <!-- Load Swell SDK with defer to not block rendering -->
    <script src="https://cdn.jsdelivr.net/npm/swell-js@4.2.5/dist/swell.umd.min.js" defer></script>

    <!-- Initialize Swell after page loads -->
    <script defer>
        window.swellCartCount = 0; // Initialize global cart count
        window.swellInitialized = false; // Flag to track initialization

        // Define the function for global access
        window.initializeSwell = async function() {
            if (window.swellInitialized) {
                console.log("Swell already initialized");
                return swell; 
            }

            try {
                // Initialize with improved options
                await swell.init('dendearts', 'pk_kWLyA4guBdwbH1pwBV32Dp7smCsqlIgK', {
                    useCamelCase: true,
                    persist: 'localstorage',
                    cache: true,           // Enable caching
                    timeout: 5000          // Reasonable timeout
                });
                console.log('Swell initialized successfully');
                window.swellInitialized = true;
                
                // Set up the cached cart system after Swell is initialized
                setupCachedCart();
                
                // Get the cart and update the global variable
                const cart = await swell.cachedCart.get();
                window.swellCartCount = cart?.itemQuantity || 0;
                updateCartCount();
                
                return swell;
            } catch (error) {
                console.error('Swell initialization error:', error);
                return null;
            }
        };
        
        // Wait for window load to ensure this runs after all critical rendering
        window.addEventListener('load', function() {
            window.initializeSwell();
        });
        
        // Setup the cached cart system
        function setupCachedCart() {
            swell.cachedCart = {
                data: null,
                lastFetched: 0,
                ttl: 60000, // 1 minute TTL
                
                async get() {
                    const now = Date.now();
                    if (!this.data || now - this.lastFetched > this.ttl) {
                        this.data = await swell.cart.get();
                        this.lastFetched = now;
                    }
                    return this.data;
                },
                
                async updateItem(id, data) {
                    // Try to update local cache optimistically
                    if (this.data && this.data.items) {
                        const itemIndex = this.data.items.findIndex(item => item.id === id);
                        if (itemIndex >= 0) {
                            // Apply the update to our local cache
                            const updatedItem = { ...this.data.items[itemIndex], ...data };
                            this.data.items[itemIndex] = updatedItem;
                            
                            // Recalculate totals if quantity changed
                            if (data.quantity) {
                                let itemQuantity = 0;
                                this.data.items.forEach(item => {
                                    itemQuantity += item.quantity;
                                });
                                this.data.itemQuantity = itemQuantity;
                            }
                        }
                    }
                    
                    // Perform the actual API call
                    const result = await swell.cart.updateItem(id, data);
                    this.data = result;
                    this.lastFetched = Date.now();
                    return result;
                },
                
                async removeItem(id) {
                    // Try to update local cache optimistically
                    if (this.data && this.data.items) {
                        const itemIndex = this.data.items.findIndex(item => item.id === id);
                        if (itemIndex >= 0) {
                            // Remove the item from our local array
                            const removedItem = this.data.items[itemIndex];
                            this.data.items.splice(itemIndex, 1);
                            
                            // Update the item count
                            this.data.itemQuantity -= removedItem.quantity;
                        }
                    }
                    
                    // Perform the actual API call
                    const result = await swell.cart.removeItem(id);
                    this.data = result;
                    this.lastFetched = Date.now();
                    return result;
                },
                
                async addItem(data) {
                    const result = await swell.cart.addItem(data);
                    this.data = result;
                    this.lastFetched = Date.now();
                    return result;
                }
            };
        }
    </script>
    
</body>
</html>